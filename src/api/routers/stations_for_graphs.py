import logging
from fastapi import HTTPException, APIRouter
from src.api.historical_data_gov.getters import *
from fastapi.responses import JSONResponse
from dotenv import load_dotenv

load_dotenv()
router = APIRouter()
logger = logging.getLogger(__name__)


@router.get("/graph_stations/")
async def get_graph_stations_daily():
    channels = ['_id', 'stn_num', 'time_obs',
                'tmp_air_max', 'tmp_air_min',
                'tmp_grass_min', 'sns_drt',
                'rpr_gale', 'year',
                'month', 'day', 'monthyear']
    df = get_historical_data_daily(channels=channels)
    non_none_columns = df.columns[df.notna().any()]

    # Converting the result to a list
    non_none_columns_list = non_none_columns.tolist()

    # Displaying the column names
    print(non_none_columns_list)
    return


def get_graph_stations_hourly():
    channels = ['_id', 'stn_num', 'time_obs', 'prs_stn', 'prs_sea_lvl',
                'prs_lvl_hgt', 'tmp_air_dry', 'tmp_air_wet', 'tmp_dew_pnt',
                'hmd_rlt', 'wind_dir', 'wind_spd', 'year', 'month', 'day',
                'hour', 'monthyear', 'date']




def get_graph_stations_rain():
    stations = [110021, 110050, 110200, 110351, 110390, 110502, 110521, 110552, 110600,
                110695, 110951, 111001, 111145, 111510, 111650, 111699, 111800, 120202,
                120530, 120570, 120629, 120750, 120770, 120800, 120860, 120870, 120900,
                121030, 121056, 121110, 121142, 121350, 121360, 121500, 121540, 121541,
                121550, 121651, 121702, 121710, 121801, 121851, 121852, 121870, 121900,
                122097, 122502, 130011, 130502, 130550, 130850, 130970, 130981, 131282,
                131598, 131599, 131752, 131801, 132430, 132905, 133200, 133302, 133399,
                133500, 133540, 133649, 133742, 133782, 133850, 133871, 134001, 134731,
                134804, 134840, 135160, 135496, 135949, 136051, 136072, 136320, 136650,
                136739, 136741, 137015, 137020, 137251, 137261, 137350, 137549, 138120,
                138250, 138272, 138401, 138510, 138780, 138946, 138947, 140025, 140050,
                140101, 140198, 140201, 140300, 140801, 140818, 140852, 140855, 140900,
                140950, 141102, 141150, 141350, 141746, 141747, 141940, 141942, 142302,
                142303, 142348, 142421, 142600, 142898, 143000, 143160, 143221, 143702,
                143952, 144001, 144030, 144702, 144800, 144873, 144960, 210062, 210151,
                210160, 210398, 210502, 210700, 210748, 210753, 210803, 211010, 211100,
                211152, 211251, 211253, 211350, 211401, 211465, 211472, 211605, 211782,
                211890, 211900, 212168, 212171, 212352, 212651, 212670, 212696, 212840,
                212846, 212980, 213119, 213130, 213160, 213173, 213201, 213212, 213240,
                213451, 213598, 213681, 213775, 213881, 213905, 214101, 214202, 214580,
                214701, 214810, 215051, 215403, 215452, 215454, 216101, 216255, 220048,
                220049, 220102, 220300, 220350, 220530, 220550, 220601, 220850, 220901,
                221202, 221252, 221604, 221633, 221650, 221705, 221751, 230050, 230253,
                230300, 230453, 230457, 230521, 230601, 230703, 230750, 231001, 240082,
                240090, 240212, 241005, 241135, 241145, 241220, 241260, 241296, 241361,
                241381, 241414, 241430, 241487, 241492, 241521, 241640, 241933, 241960,
                241975, 241985, 242010, 242320, 242550, 242772, 242925, 242951, 243101,
                243110, 243200, 243310, 243331, 243501, 243530, 243798, 244353, 244354,
                244731, 244850, 245005, 245464, 245500, 245782, 246550, 246551, 246630,
                247002, 247003, 247206, 247211, 247212, 247215, 247220, 247251, 247370,
                247412, 247420, 247550, 247881, 248360, 248370, 248396, 250151, 250156,
                250250, 250398, 250600, 251011, 251120, 251451, 251550, 251569, 251599,
                252296, 252305, 252428, 252506, 252730, 252731, 253000, 253010, 253052,
                253745, 256003, 259133, 310051, 310083, 310093, 310120, 310191, 310552,
                310603, 310799, 311070, 311208, 311251, 311450, 311501, 311650, 311655,
                311656, 311660, 311700, 320099, 320350, 320405, 320448, 320502, 320702,
                320703, 320850, 320901, 321148, 321250, 321802, 321803, 321850, 322102,
                322656, 323255, 323402, 323403, 330210, 330381, 330455, 330810, 331210,
                337001, 251692, 340534, 342507, 345006, 2311572, 2488708, 2488800, 2489600,
                2492950, 2493301, 2493330, 2493350, 2, 494353, 2494552, 2494661, 2496028, 2496501,
                2496600, 310098, 214252, 213054, 134101, 120701, 211941, 131003, 210903,
                242414, 320752, 213902, 221802, 230404, 141854, 311207, 130352, 214551,
                211330, 311202, 144248, 214910, 243022, 133980]
    channels = ['_id', 'stn_num', 'time_obs', 'rain_06_next', 'rain_code', 'year', 'month', 'day', 'monthyear']


def get_graph_stations_radiation():
    stations_radiation = [850, 2524, 3891, 7020, 7839, 9772]
    channels = ['_id', 'stn_num', 'time_obs', 'rad_type', 'rad_04', 'rad_05', 'rad_06', 'rad_07', 'rad_08', 'rad_09',
                'rad_10', 'rad_11', 'rad_12', 'rad_13', 'rad_14', 'rad_15', 'rad_16', 'rad_17', 'year', 'month', 'day',
                'monthyear']
